<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta HTTP-EQUIV="pragma" CONTENT="no-cache">
    <meta HTTP-EQUIV="Cache-Control" CONTENT="no-store, must-revalidate">
    <meta HTTP-EQUIV="expires" CONTENT="Wed, 26 Feb 1997 08:21:57 GMT">
    <meta HTTP-EQUIV="expires" CONTENT="0">
    <meta name="renderer" content="webkit">
    <link rel="stylesheet" type="text/css" href="/resources/new/base_new.css?v=da63245499">
    <style>
        html,
        body {
            color: #000;
        }

        .Customer-address {
            color: #000;
        }

        .talRight {
            text-align: right;
        }

        .talCenter {
            text-align: center;
        }

        .order {
            position: absolute;
            right: 25px;
            top: 20px;
            font-size: 12px;
        }

        .header {
            text-align: center;
            font-size: 18px;
            color: #000;
        }

        html,
        body {
            font-size: 16px;
        }

        th {
            font-weight: normal;
        }

        .Customer-address {
            font-size: 12px;
        }

        table,
        th,
        td {
            vertical-align: top;
        }

        .datagrid-body tr>td:last-child,
        .datagrid-header tr>td:last-child {
            border-right: none !important;
        }

        .ui.items-view table tbody tr:nth-child(even) {
            background: none !important;
        }

        .ui.items-view .item {
            cursor: default;
        }

        #order .table-wrapper>table thead th:nth-child(11),
        #order .table-wrapper>table thead th:nth-child(1),
        #order .table-wrapper>table thead th:nth-child(12),
        #order .table-wrapper>table thead th:nth-child(2) {
            font-weight: 700;
        }

        .pagination table {
            height: 50px;
            line-height: 50px;
            float: right;
        }

        .datagrid-row-over,
        .datagrid-header td.datagrid-header-over {
            background: none !important;
            color: #000;
            cursor: default;
        }

        .datagrid-header td,
        .datagrid-body td,
        .datagrid-footer td {
            border-style: solid;
            border-color: #e4e4e4;
        }

        .datagrid-header-row,
        .datagrid-row {
            height: 30px;
            line-height: 30px;
        }

        table,
        th,
        td {
            vertical-align: middle;
        }

        .datagrid-header .datagrid-cell {
            text-align: center !important;
        }

        .datagrid-body td {
            position: relative;
        }

        .datagrid-cell a:hover,
        .datagrid-cell a:visited,
        .datagrid-cell a:link {
            color: #4284d9;
            text-decoration: none;
        }


       .line{
            border-bottom:1px solid #000;
            box-sizing: border-box;
            padding: 0 20px 10px; 
        }

        #print {
            border: none;
            /*padding: 10px 20px;*/
            border-radius: 5px;
        }

        .sales {
            margin: 5px;
        }

        .list_one {
            text-align: center;
            margin: 20px;
            font-size: 16px;
        }

        .code {
            /*display: none;*/
            position: absolute;
            top: 0px;
        }

        .codeone {
            display: none;
            position: absolute;
            top: 0;
        }

        .total-preson {
            position: absolute;
            width: 70%;
            left: 0;
            bottom: 12px;
            margin-left: 300px;
        }

        .total-preson p {
            line-height: normal;
            margin-bottom: 8px;
        }

        /*.money {
            margin-left: 100px;
        }*/

        .empoy {
            margin-bottom: 8px;
            border-bottom: 1px solid #000;
        }

        .division {
            border-bottom: 1px solid #000;
            margin: 10px 0;
        }

        .sales #print {
            display: block;
            width: 120px;
            background: #2e8ae6;
            margin: 50px auto;
            color: #fff;
            height: 30px;
        }

        .clear {
            clear: both;
        }

        .total_right li {
            margin-top: 2px;
        }

        .total_beizhu {
            position: absolute;
            width: 100%;
            height: auto;
            top: 10px;
            text-decoration: none;
            float: left;
        }

        b {
            margin-left: 5px;
        }

        .datagrid .panel-body {
            border-bottom: none;
        }

        .datagrid-header,
        .datagrid-td-rownumber {
            background: none !important;
        }

        .datagrid-header,
        .datagrid-toolbar,
        .datagrid-pager,
        .datagrid-footer-inner,
        .datagrid-header td,
        .datagrid-body td,
        .datagrid-footer td,
        .panel-header,
        .panel-body {
            border-color: #000;
        }

        .ding {
            padding-bottom: 7px;
        }

        table,
        table td,
        table th {
            border-collapse: collapse;
            border: 1px solid #000;
        }

        table td,
        table th {
            color: #000;
            height: 30px;
            padding: 0 3px;
            line-height: 30px;
        }



        *,
        *:before,
        *:after {
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
        }

        html {
            /*font-size: 62.5%;*/
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        }

        .alipayCls {
            width: 120px;
            height: 100px;
            display: inline-block;
        }

        .wechatCls {
            width: 120px;
            height: 100px;
            display: inline-block;
        }
    </style>
    <style media="print">
        .sales #print,
        #plugin {
            display: none;
        }
    </style>
    <script src="/resources/jquery/jquery-2.1.3.min.js?v=a03e4bc153"></script>
    <script src="/resources/cola-ui/china_city.js?v=bef170068c"></script>
    <script src="/resources/business/base_new.js?v=9ac481258d"></script>
    <script src="/resources/easyui/pace.min.js?v=cdbdd88ddf"></script>
</head>

<body style="border:none !important;padding:10px 25px 0px 25px;width:1100px;margin:0 auto;position:relative;">
    <div id="datagrid-mask-msg" class="frame_box datagrid-mask-msg" style="display:block;left:50%"><span></span></div>
    <div id="content">

    </div>
    <script id="tpl-print" type="text/html">
        <div class="header"><span class="line"><span>{{saleOrder.comName}}</span>&#x3000;<span>销售单</span> <span>( {{saleOrder.orderDate}} )</span></span></div>
        <div class="order">
            <p>销售单号 : <span></span></p>
            <p>采购单号 : <span class="cont"></span></p>
        </div>
        <div class="list_one">
           <span>客户 :{{saleOrder.partnerShortname}}</span>&#x3000; <span>税号 :{{saleOrder.taxNo}}</span>&#x3000; <span>{{saleOrder.contactName}} ({{saleOrder.contactTel}})</span>&#x3000; <span>地址 :{{bottomComInfo.partnerAddress}}</span>
        </div>
        <table id="order" style="width:100%;">
            <col width="17%" />
            <col width="15%" />
            <col width="10%" />
            <col width="5%" />
            <col width="7%" />
            <col width="7%" />
            <col width="7%" />
            <col width="9%" />
            <col width="10%" />
            <thead>
                <th>业务内容</th>
                <th>物料/制作/说明</th>
                <th>规格(m)</th>
                <th>数量</th>
                <th>面积(㎡)</th>
                <th>单位</th>
                <th>单价</th>
                <th>行小计</th>
                <th>备注</th>
            </thead>
            <tbody>
                {{each orders as item i}}
                <tr>
                    <td>{{item.businessDesc}}</td>
                    <td>{{item.requirements}}</td>
                    <td class="talCenter">{{item.specification}}</td>

                    <td class="talRight">{{item.quantity}}</td>
                    <td class="talCenter">{{item.totalArea}}</td>
                    <td class="talCenter">{{item.unit}}</td>
                    <td class="talRight">{{item.unitPrice | formatNumber}}</td>
                    <td class="talRight">{{item.totalPrice | formatNumber}}</td>
                    <td>{{item.remarks}}</td>
                </tr>
            </tbody>
            {{/each}}
        </table>

        <div class="ui form">
            <div id="tableContainer" class="field" style="margin-bottom: 10px;"></div>
            <div class="total-drive" style="position:relative;">
                <div>
                    <div style="float:left;width:40%;margin-left:300px;margin-top:2px;">
                        <div>备注 : <span id="shifouweikong">{{saleOrder.remarks}}</span></div>
                    </div>
                    <div class="total_right">

                        <ul class='ding'>
                            <li>合&#x3000;&#x3000;计 :<span>{{saleOrder.price | formatNumber}}</span></li>
                            <li>折&#x3000;&#x3000;扣 :<span> - <i>{{saleOrder.discount | formatNumber}}</i> </span></li>
                            <li>减&#x3000;&#x3000;免 :<span> - <i>{{saleOrder.preferential | formatNumber}}</i> </span></li>
                            <div class='division'></div>
                        </ul>
                    </div>
                    <div style="clear:both;"></div>
                </div>
                <div style="position:relative;">
                    <div class="total_left" style="float:right;width:25%;">
                        <ul>
                            <li style='margin-bottom:8px;'>订单金额 :<span style='float:right;'>{{saleOrder.totalPrice | formatNumber}}</span></li>
                            <li>预&#x3000;&#x3000;收 :<span style='float:right;'> - <i>{{saleOrder.depositRequested | formatNumber}}</i> </span></li>
                        </ul>

                    </div>
                    <div class="total-preson">
                        <p><span class='money'>未付款签字 :</span></p>
                    </div>
                    <div style="clear:both;"></div>
                </div>
                <div class="code">
                    <span class="alipayCls" style=""></span>
                    <span class="wechatCls" style=""></span>
                </div>
            </div>
        </div>
        <div class="empoy"></div>
        <div class="Customer-address">
           电话 : <span>{{bottomComInfo.comTel}}</span> QQ : <span>{{bottomComInfo.comQQ}}</span><span class="relation"> 联系人 : <span style='margin:0;'>{{bottomComInfo.realName}} ({{bottomComInfo.userId}})</span></span><span class="addr">地址 : <span>
                   
               <b>{{bottomComInfo.comAddress}}</b>
</span></span> 
            <span style="float:right;margin:0;">
    制单人 ：<span style="margin:0;">{{saleOrder.creatorName}} ({{saleOrder.createTime}})</span>
            </span>
        </div>
        <h4 class="sales">
            <button onclick="window.print()" id="print">打印</button>
        </h4>
    </script>
    <script>
        function GetRequest() {
            var url = location.search; //获取url中"?"符后的字串
            var theRequest = new Object();
            if (url.indexOf("?") != -1) {
                var str = url.substr(1);
                strs = str.split("&");
                for (var i = 0; i < strs.length; i++) {
                    theRequest[strs[i].split("=")[0]] = unescape(strs[i].split("=")[1]);
                }
            }
            return theRequest;
        }

        // type :print /share;    param:salesNo  key    url:
        function pageLoad(type, param, url) {
            $.get(url + param)
                .then(function (date) {

                    //var date = JSON.parse(data);
                    template.defaults.imports.formatNumber = function (value) {
                        return accounting.formatNumber(value, 2);
                    };
                    var html = template('tpl-print', date);
                    document.getElementById("content").innerHTML = html;
                    $("title").text("销售订单");
                    // 收款二微码显隐判断
                    $(".alipayCls").css({"background": "url('/resources/images/qrpay/alipay/"+date.saleOrder.comKey+".png')"});
                    $(".wechatCls").css({"background": "url('/resources/images/qrpay/wechat/"+date.saleOrder.comKey+".png')"});

                    
                    if (date.bottomComInfo.partnerProvince == "" && date.bottomComInfo.partnerCountry == "" && date.bottomComInfo.partnerCity == "" && date.bottomComInfo.partnerAddress == "") {
                        $(".address").hide()
                    } else {
                        $.each(ProvinceJson, function (key, val) {
                            if (val.provinceId == date.bottomComInfo.partnerProvince) {
                                $(".province").html(val.provinceName);
                                return false;
                            }
                        });

                        $.each(CityJson, function (key, val) {
                            if (val.provinceId == date.bottomComInfo.partnerProvince && val.cityId == date.bottomComInfo.partnerCity) {
                                $(".city").html(val.cityName);
                                return false;
                            }
                        });

                        $.each(CountryJson, function (key, val) {
                            if (val.cityId == date.bottomComInfo.partnerCity && val.countryId == date.bottomComInfo.partnerCountry) {
                                $(".country").html(val.countryName);
                                return false;
                            }
                        });
                    }
                    $.each(ProvinceJson, function (key, val) {
                        if (val.provinceId == date.bottomComInfo.comProvince) {
                            $("#sheng1").html(val.provinceName);
                            return false;
                        }
                    });

                    $.each(CityJson, function (key, val) {
                        if (val.provinceId == date.bottomComInfo.comProvince && val.cityId == date.bottomComInfo.comCity) {
                            $("#shi1").html(val.cityName);
                            return false;
                        }
                    });

                    $.each(CountryJson, function (key, val) {
                        if (val.cityId == date.bottomComInfo.comCity && val.countryId == date.bottomComInfo.comCountry) {
                            $("#xian2").html(val.countryName);
                            return false;
                        }
                    });

                    $(".order span").eq(0).text(date.saleOrder.salesNo);
                    if (date.bottomComInfo.realName == "-" && date.bottomComInfo.userId == "-") {
                        $(".relation").hide();
                    }
                    if (date.bottomComInfo.comAddress == "-") {
                        $(".addr").hide();
                    }
                    if (date.saleOrder.discount == "" || date.saleOrder.discount == "null") {
                        $(".total_right li").eq(1).hide()
                    }
                    if (date.saleOrder.preferential == "" || date.saleOrder.preferential == "null") {
                        $(".total_right li").eq(2).hide()
                    }
                    if (date.saleOrder.purchaseNo == "" || date.saleOrder.purchaseNo == "null") {
                        $(".order p").eq(1).hide()
                    } else {
                        $(".cont").text(date.saleOrder.purchaseNo)
                    }
                    //                $(".header span").eq(0).text(date.saleOrder.comName)
                })

        }
       pageLoad("share", escape(GetRequest().key1), "/ordershare/salesorderdetail/");

    </script>
</body>

</html>